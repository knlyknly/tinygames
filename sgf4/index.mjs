import { parse, stringify } from './parser-ast.mjs';
import yaml from 'https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.mjs';
import { SgfModel } from './parser-go.mjs';

const text = `(;GM[1]FF[4]SZ[19]GN[]DT[2025-03-15]PB[灵弈事件]PW[flmq]BR[6级]WR[3段]KM[0.5]HA[4]RU[Japanese]AP[KaTrain:1.15.0]RE[W+R]TM[3600]TC[3]TT[60]RL[0]CA[UTF-8]KTV[1.0]C[SGF generated by KaTrain 1.15.0ㅤ​];AB[pd][dp]AB[dd][pp]C[让四子
ㅤㅤ
贴目: 0.5
规则设置: 日本规则
ㅤ​];W[nq]C[WWWW](;AB[pn]AW[pq]C[分支1];B[qq])(;AB[qq]AW[pq]C[分支2];B[pn]);B[pn]C[BBBB];W[pq];B[qq];W[qr];B[rr];W[qp];B[rq];W[op];B[po];W[pr]C[手数 11: W Q2
分数: B+50.9
胜率: B 100.0%
目数损失: 3.9
推荐最佳选点 K4 (B+47.0).
PV: WK4 N4 P2 M3 O5
直觉选点下该手棋是 #250 (0.03%).
最佳直觉选点是 P2 (18.9%).
ㅤ​];B[lq];W[jq];B[lo]C[手数 14: B M5
分数: B+49.4
胜率: B 100.0%
目数损失: 2.8
推荐最佳选点 K4 (B+53.0).
PV: BK4 J4 L4 O6 J3 H3
直觉选点下该手棋是 #6 (0.69%).
最佳直觉选点是 L4 (23.8%).
ㅤ​];W[lr];B[kr]C[手数 16: B L2
分数: B+45.1
胜率: B 100.0%
目数损失: 3.5
推荐最佳选点 R12 (B+48.8).
PV: BR12 L3 M4 S5
直觉选点下该手棋是 #4 (5.66%).
最佳直觉选点是 N2 (31.6%).
ㅤ​];W[kq];B[mr];W[lp];B[mq];W[mp];B[jr];W[nr]C[手数 23: W O2
分数: B+48.5
胜率: B 100.0%
目数损失: 2.6
推荐最佳选点 M1 (B+45.1).
PV: WM1 J3 O2 C6 R7 Q7 R9
直觉选点下该手棋是 #8 (1.22%).
最佳直觉选点是 M1 (42.3%).
ㅤ​];B[ls];W[ir]C[手数 25: W J2
分数: B+52.4
胜率: B 100.0%
目数损失: 3.6
推荐最佳选点 L5 (B+47.9).
PV: WL5 J3 O6 K5 L6 J4
直觉选点下该手棋是 #21 (0.18%).
最佳直觉选点是 J3 (38.3%).
ㅤ​];B[iq];W[hr];B[ip];W[jo];B[gq];W[gr];B[js]C[手数 32: B K1
分数: B+47.5
胜率: B 100.0%
目数损失: 5.2
推荐最佳选点 O5 (B+53.7).
PV: BO5 N5 F3 F2 E2 E3
直觉选点下该手棋是 #7 (1.16%).
最佳直觉选点是 F3 (39.8%).
ㅤ​];W[fq];B[io];W[ko];B[ln];W[dq]C[手数 37: W D3
分数: B+50.8
胜率: B 100.0%
目数损失: 5.2
推荐最佳选点 K7 (B+44.9).
PV: WK7 O5 O4 E2 J6 F5
直觉选点下该手棋是 #14 (0.31%).
最佳直觉选点是 K7 (38.0%).
ㅤ​];B[in]C[手数 38: B J6
分数: B+45.2
胜率: B 100.0%
目数损失: 5.6
推荐最佳选点 K6 (B+51.7).
PV: BK6 P6 Q7 L6 L7 L4 C3 E3
直觉选点下该手棋是 #8 (0.14%).
最佳直觉选点是 K6 (33.1%).
ㅤ​];W[ns];B[ms];W[no]C[手数 41: W O5
分数: B+48.8
胜率: B 100.0%
目数损失: 4.3
推荐最佳选点 C4 (B+43.5).
PV: WC4 C3 D5 O5 O4 L6
直觉选点下该手棋是 #8 (1.54%).
最佳直觉选点是 O6 (28.9%).
ㅤ​];B[kp]C[手数 42: B L4
分数: B+41.5
胜率: B 100.0%
目数损失: 7.4
推荐最佳选点 C3 (B+49.0).
PV: BC3 E3 C2 S5 S6 S7 T6 Q7 E5 R6
直觉选点下该手棋是 #5 (0.50%).
最佳直觉选点是 C3 (77.6%).
ㅤ​];W[jp]C[手数 43: W K4
分数: B+49.1
胜率: B 100.0%
目数损失: 7.6
推荐最佳选点 E4 (B+41.2).
PV: WE4 P8 D5 N5 K4 L6 R1
直觉选点下该手棋是 #43 (0.10%).
最佳直觉选点是 E4 (32.9%).
ㅤ​];B[kn]C[手数 44: B L6
分数: B+42.9
胜率: B 100.0%
目数损失: 6.1
推荐最佳选点 C3 (B+49.2).
PV: BC3 E3 C2 K6 K7 J7 K8 J8 J9 G7
直觉选点下该手棋是 #3 (0.81%).
最佳直觉选点是 C3 (80.0%).
ㅤ​];W[nm]C[手数 45: W O7
分数: B+50.0
胜率: B 100.0%
目数损失: 7.1
推荐最佳选点 E4 (B+42.5).
PV: WE4 P7 D5 P2 O7 O8
直觉选点下该手棋是 #8 (0.19%).
最佳直觉选点是 E4 (31.9%).
ㅤ​];B[jn]C[手数 46: B K6
分数: B+40.7
胜率: B 100.0%
目数损失: 9.3
推荐最佳选点 C3 (B+50.2).
PV: BC3 E3 C2 S5 S6 S7 T6 R7 R6 S4
直觉选点下该手棋是 #141 (0.04%).
最佳直觉选点是 C3 (73.7%).
ㅤ​];W[mo]C[手数 47: W N5
分数: B+51.7
胜率: B 100.0%
目数损失: 11.0
推荐最佳选点 C4 (B+40.3).
PV: WC4 P8 S5 S6 S7 R7 T6 R6
直觉选点下该手棋是 #260 (0.01%).
最佳直觉选点是 E4 (31.2%).
ㅤ​];B[kp]C[手数 48: B L4
分数: B+38.0
胜率: B 100.0%
目数损失: 13.7
推荐最佳选点 C3 (B+51.8).
PV: BC3 E3 C2 S7 S5 D6 E5
直觉选点下该手棋是 #207 (0.01%).
最佳直觉选点是 C3 (80.2%).
ㅤ​];W[cp];B[pl];W[fc];B[df];W[jd];B[lc];W[nc];B[hd];W[dc];B[cc];W[ed]C[手数 59: W E16
分数: B+39.8
胜率: B 100.0%
目数损失: 3.2
推荐最佳选点 C18 (B+36.2).
PV: WC18 E17 D18 E16 E18 B17 F16 G18
直觉选点下该手棋是 #21 (0.37%).
最佳直觉选点是 C18 (54.9%).
ㅤ​];B[db];W[eb];B[ec];W[rp]C[手数 63: W S4
分数: B+44.4
胜率: B 100.0%
目数损失: 2.8
推荐最佳选点 E4 (B+41.2).
PV: WE4 E15 D17 P5 E17 C18 C16
直觉选点下该手棋是 #131 (0.03%).
最佳直觉选点是 E4 (19.7%).
ㅤ​];B[ro];W[dc];B[cd]C[手数 66: B C16
分数: B+39.0
胜率: B 100.0%
目数损失: 5.0
推荐最佳选点 D5 (B+44.5).
PV: BD5 D15 E17 E15 C15 D17 C3
直觉选点下该手棋是 #158 (0.02%).
最佳直觉选点是 E15 (31.1%).
ㅤ​];W[md];B[kd];W[ke];B[jc];W[ld];B[kc];W[id]C[手数 73: W J16
分数: B+43.8
胜率: B 100.0%
目数损失: 3.5
推荐最佳选点 K15 (B+40.0).
PV: WK15 H17 Q14 Q18 E4
直觉选点下该手棋是 #10 (0.46%).
最佳直觉选点是 K15 (57.6%).
ㅤ​];B[ic];W[he];B[ge];W[gd];B[hc];W[hf];B[gf];W[hg];B[gc]C[手数 82: B G17
分数: B+42.2
胜率: B 100.0%
目数损失: 5.4
推荐最佳选点 K15 (B+48.5).
PV: BK15 G13 F14 J15 K14 C18
直觉选点下该手棋是 #129 (0.02%).
最佳直觉选点是 K15 (28.5%).
ㅤ​];W[gg]C[手数 83: W G13
分数: B+44.6
胜率: B 100.0%
目数损失: 2.4
推荐最佳选点 R14 (B+41.7).
PV: WR14 K15 L14 P17 C18
直觉选点下该手棋是 #7 (2.35%).
最佳直觉选点是 R14 (32.7%).
ㅤ​];B[fg]C[手数 84: B F13
分数: B+41.9
胜率: B 100.0%
目数损失: 2.7
推荐最佳选点 K15 (B+45.4).
PV: BK15 R14 L14 M15 J15
直觉选点下该手棋是 #53 (0.08%).
最佳直觉选点是 E15 (26.9%).
ㅤ​];W[fh];B[fe]C[手数 86: B F15
分数: B+33.2
胜率: B 100.0%
目数损失: 8.5
推荐最佳选点 R14 (B+42.5).
PV: BR14 C18 E17 F16 F14 D17
直觉选点下该手棋是 #161 (0.01%).
最佳直觉选点是 F16 (35.7%).
ㅤ​];W[eg];B[fd]C[手数 88: B F16
分数: B+31.4
胜率: B 100.0%
目数损失: 1.8
推荐最佳选点 E15 (B+33.9).
PV: BE15 R14 P17 C18 F16 D19
直觉选点下该手棋是 #2 (17.14%).
最佳直觉选点是 E15 (42.0%).
ㅤ​];W[ff]C[手数 89: W F14
分数: B+34.9
胜率: B 100.0%
目数损失: 3.5
推荐最佳选点 E15 (B+30.8).
PV: WE15 E17 R14 P17 D17 C3
直觉选点下该手棋是 #75 (0.05%).
最佳直觉选点是 E15 (26.9%).
ㅤ​];B[ee];W[dg]C[手数 91: W D13
分数: B+38.4
胜率: B 100.0%
目数损失: 3.3
推荐最佳选点 R14 (B+34.8).
PV: WR14 P17 R17 R16 P18 Q17
直觉选点下该手棋是 #101 (0.02%).
最佳直觉选点是 R14 (32.8%).
ㅤ​];B[nb]C[手数 92: B O18
分数: B+36.2
胜率: B 100.0%
目数损失: 2.2
推荐最佳选点 R14 (B+39.1).
PV: BR14 R17 Q17 Q18 P18 R18 O18 S15
直觉选点下该手棋是 #85 (0.02%).
最佳直觉选点是 R14 (36.3%).
ㅤ​];W[ob];B[mb]C[手数 94: B N18
分数: B+32.5
胜率: B 100.0%
目数损失: 2.7
推荐最佳选点 P17 (B+36.0).
PV: BP17 Q18 O16 N17 N18 R16 R15 Q17 P16 S16
直觉选点下该手棋是 #125 (0.01%).
最佳直觉选点是 P17 (25.8%).
ㅤ​];W[pc];B[od];W[qd];B[oc]C[手数 98: B P17
分数: B+31.2
胜率: B 100.0%
目数损失: 1.7
推荐最佳选点 R15 (B+33.4).
PV: BR15 S16 P17 R18 Q14 S14 R13 S13
直觉选点下该手棋是 #2 (31.71%).
最佳直觉选点是 R15 (47.8%).
ㅤ​];W[pb]C[手数 99: W Q18
分数: B+33.1
胜率: B 100.0%
目数损失: 2.0
推荐最佳选点 R18 (B+30.6).
PV: WR18 R15 Q15 P19 Q18 O15 R14 S15 P15 O16 O14
直觉选点下该手棋是 #1 (51.35%).
ㅤ​];B[nd]C[手数 100: B O16
分数: B+26.3
胜率: B 99.9%
目数损失: 6.8
推荐最佳选点 R15 (B+33.8).
PV: BR15 Q15 R17 S16 P15 Q14 R18 P14 P19 R10
直觉选点下该手棋是 #53 (0.05%).
最佳直觉选点是 R15 (46.4%).
ㅤ​];W[mc]C[手数 101: W N17
分数: B+39.1
胜率: B 100.0%
目数损失: 12.8
推荐最佳选点 R15 (B+26.2).
PV: WR15 E4 E3 C5 B4 R11 S12
直觉选点下该手棋是 #68 (0.02%).
最佳直觉选点是 R15 (62.5%).
ㅤ​];B[qe];W[rd];B[me]C[手数 104: B N15
分数: B+29.5
胜率: B 99.9%
目数损失: 10.4
推荐最佳选点 S15 (B+40.2).
PV: BS15 S18 K15 P14 N14
直觉选点下该手棋是 #29 (0.14%).
最佳直觉选点是 S15 (67.9%).
ㅤ​];W[le];B[mf]C[手数 106: B N14
分数: B+27.5
胜率: B 99.9%
目数损失: 2.5
推荐最佳选点 C3 (B+31.7).
PV: BC3 E4 D5 B3 S15 Q15 Q14 P15 O15 P14 P13 O14 N14
直觉选点下该手棋是 #8 (0.82%).
最佳直觉选点是 S15 (72.3%).
ㅤ​];W[jf]C[手数 107: W K14
分数: B+37.0
胜率: B 100.0%
目数损失: 9.5
推荐最佳选点 R14 (B+27.1).
PV: WR14 R17 S17 P14 Q14 C3
直觉选点下该手棋是 #194 (0.01%).
最佳直觉选点是 R14 (69.2%).
ㅤ​];B[re];W[rb];B[lf]C[手数 110: B M14
分数: B+32.1
胜率: B 100.0%
目数损失: 4.5
推荐最佳选点 Q11 (B+37.3).
PV: BQ11 P14 Q14 O15 O14 P15 Q15 P13
直觉选点下该手棋是 #43 (0.09%).
最佳直觉选点是 Q12 (37.9%).
ㅤ​];W[of];B[pf];W[og];B[kf];W[je];B[mh]C[手数 116: B N12
分数: B+25.7
胜率: B 99.9%
目数损失: 6.9
推荐最佳选点 O15 (B+33.2).
PV: BO15 R12 R10 Q10 R11 Q12 S12
直觉选点下该手棋是 #40 (0.06%).
最佳直觉选点是 O15 (54.5%).
ㅤ​];W[pg]C[手数 117: W Q13
分数: B+31.2
胜率: B 100.0%
目数损失: 5.4
推荐最佳选点 O15 (B+25.7).
PV: WO15 Q15 Q12 S12 R10 Q11 R12 R11
直觉选点下该手棋是 #5 (0.52%).
最佳直觉选点是 O15 (89.7%).
ㅤ​];B[qg]C[手数 118: B R13
分数: B+25.2
胜率: B 99.9%
目数损失: 5.9
推荐最佳选点 O15 (B+31.4).
PV: BO15 R10 R13 R12 S13 R7 Q7
直觉选点下该手棋是 #6 (1.40%).
最佳直觉选点是 O15 (68.2%).
ㅤ​];W[ne];B[nf];W[oe];B[qh]C[手数 122: B R12
分数: B+23.1
胜率: B 99.9%
目数损失: 2.1
推荐最佳选点 Q15 (B+26.4).
PV: BQ15 R12 S13 Q11 S11 Q9 S12 P8 M10 Q7
直觉选点下该手棋是 #3 (21.09%).
最佳直觉选点是 Q15 (31.3%).
ㅤ​];W[pe];B[mj]C[手数 124: B N10
分数: B+20.6
胜率: B 99.9%
目数损失: 2.7
推荐最佳选点 Q11 (B+23.5).
PV: BQ11 C7 C3 E4 D5 B3 C5
直觉选点下该手棋是 #19 (0.15%).
最佳直觉选点是 Q11 (60.3%).
ㅤ​];W[oj]C[手数 125: W P10
分数: B+23.5
胜率: B 99.9%
目数损失: 2.9
推荐最佳选点 Q9 (B+20.3).
PV: WQ9 Q10 R10 P9 Q11 R9 R11 Q12 P11
直觉选点下该手棋是 #26 (0.19%).
最佳直觉选点是 Q9 (37.1%).
ㅤ​];B[qj];W[pk];B[qk];W[ol];B[om];W[on]C[手数 131: W P6
分数: B+25.7
胜率: B 99.9%
目数损失: 3.2
推荐最佳选点 Q11 (B+22.0).
PV: WQ11 R11 M9 M10 L9 O11
直觉选点下该手棋是 #41 (0.07%).
最佳直觉选点是 Q11 (36.0%).
ㅤ​];B[pm];W[nl]C[手数 133: W O8
分数: B+28.1
胜率: B 99.9%
目数损失: 2.3
推荐最佳选点 C7 (B+25.3).
PV: WC7 E4 F4 C6 B6
直觉选点下该手棋是 #34 (0.17%).
最佳直觉选点是 E4 (25.7%).
ㅤ​];B[jg]C[手数 134: B K13
分数: B+25.1
胜率: B 99.9%
目数损失: 2.9
推荐最佳选点 E4 (B+29.4).
PV: BE4 E3 C5 B4 C7 M9 L10
直觉选点下该手棋是 #74 (0.04%).
最佳直觉选点是 C5 (42.7%).
ㅤ​];W[kk];B[pj]C[手数 136: B Q10
分数: B+22.6
胜率: B 99.9%
目数损失: 3.5
推荐最佳选点 E4 (B+27.1).
PV: BE4 E3 C5 L11 N8 M8
直觉选点下该手棋是 #83 (0.02%).
最佳直觉选点是 K10 (29.2%).
ㅤ​];W[nj]C[手数 137: W O10
分数: B+24.1
胜率: B 99.9%
目数损失: 1.5
推荐最佳选点 O11 (B+22.5).
PV: WO11 L10 K10 M9 L11 M10
直觉选点下该手棋是 #13 (0.65%).
最佳直觉选点是 O11 (28.7%).
ㅤ​];B[ng]C[手数 138: B O13
分数: B+16.7
胜率: B 99.3%
目数损失: 7.4
推荐最佳选点 K10 (B+24.6).
PV: BK10 M11 L11 M12 N11
直觉选点下该手棋是 #75 (0.03%).
最佳直觉选点是 L10 (28.9%).
ㅤ​];W[ni]C[手数 139: W O11
分数: B+22.7
胜率: B 99.8%
目数损失: 6.0
推荐最佳选点 M11 (B+16.0).
PV: WM11 L11 M10 K10 K9 M12 K12
直觉选点下该手棋是 #29 (0.10%).
最佳直觉选点是 L11 (44.3%).
ㅤ​];B[mi]C[手数 140: B N11
分数: B+19.9
胜率: B 99.2%
目数损失: 2.8
推荐最佳选点 K11 (B+22.8).
PV: BK11 L11 L12 M11 N11 M9 J10 J9
直觉选点下该手棋是 #5 (0.38%).
最佳直觉选点是 K11 (44.8%).
ㅤ​];W[ki];B[kh]C[手数 142: B L12
分数: B+14.2
胜率: B 98.4%
目数损失: 5.9
推荐最佳选点 M9 (B+21.0).
PV: BM9 M8 N8 M10 N9 N7 L8 M7 K9 L10 L12 K8 L7
直觉选点下该手棋是 #5 (12.39%).
最佳直觉选点是 M9 (26.7%).
ㅤ​];W[li]C[手数 143: W M11
分数: B+23.0
胜率: B 99.7%
目数损失: 8.8
推荐最佳选点 K11 (B+14.1).
PV: WK11 L10 K10 M9 M8 L8 M10 M11 E4 C8 C10 E7 F7
直觉选点下该手棋是 #5 (1.41%).
最佳直觉选点是 K11 (79.1%).
ㅤ​];B[ji];W[lk];B[nh]C[手数 146: B O12
分数: W+3.0
胜率: W 71.1%
目数损失: 26.6
推荐最佳选点 J10 (B+24.4).
PV: BJ10 J12 K12 J9 H9 J8 G10 F9
直觉选点下该手棋是 #35 (0.01%).
最佳直觉选点是 J10 (31.4%).
ㅤ​];W[oh]C[手数 147: W P12
分数: B+23.4
胜率: B 99.7%
目数损失: 26.4
推荐最佳选点 J10 (W+3.4).
PV: WJ10 P12 Q12 N9 N8 Q11 P11 M8 J12 P5 O6 P2 S1 R5
直觉选点下该手棋是 #35 (0.00%).
最佳直觉选点是 J10 (37.9%).
ㅤ​];B[jk]C[手数 148: B K9
分数: B+20.4
胜率: B 99.6%
目数损失: 3.0
推荐最佳选点 J10 (B+24.0).
PV: BJ10 J12 K12 J9 H9 J8 N9 N8 G10 H8
直觉选点下该手棋是 #2 (19.79%).
最佳直觉选点是 J10 (39.4%).
ㅤ​];W[ih];B[jh];W[jl];B[ik];W[il];B[mn]C[手数 154: B N6
分数: W+14.7
胜率: W 99.1%
目数损失: 35.0
推荐最佳选点 N9 (B+20.5).
PV: BN9 N8 L8 M8 H8 H9 L7 H10 J11
直觉选点下该手棋是 #80 (0.00%).
最佳直觉选点是 H9 (34.4%).
ㅤ​];W[hk]C[手数 155: W H9
分数: W+12.1
胜率: W 99.0%
目数损失: 2.6
推荐最佳选点 H8 (W+15.4).
PV: WH8 C3 E4 D5 B3 C2 C5
直觉选点下该手棋是 #1 (48.38%).
ㅤ​];B[jj]C[手数 156: B K10
分数: W+20.6
胜率: W 99.6%
目数损失: 8.5
推荐最佳选点 C3 (W+11.3).
PV: BC3 D5 E4 E3 B4 C5 H8 H10
直觉选点下该手棋是 #64 (0.02%).
最佳直觉选点是 C3 (28.7%).
ㅤ​];W[hj]C[手数 157: W H10
分数: W+17.3
胜率: W 99.4%
目数损失: 3.2
推荐最佳选点 G8 (W+21.1).
PV: WG8 H10 E9 D9 E8
直觉选点下该手棋是 #5 (2.59%).
最佳直觉选点是 G8 (38.8%).
ㅤ​];B[lh];W[lg];B[lj];W[kj];B[mk];W[ml];B[kl];W[ll];B[nn];W[oo];B[hl];W[gl];B[hm];W[km];B[ep];W[eq];B[dn];W[fp]C[手数 175: W F4
分数: W+20.4
胜率: W 99.9%
目数损失: 1.9
推荐最佳选点 B6 (W+22.6).
PV: WB6 B13 F4 B11 F6
直觉选点下该手棋是 #27 (0.24%).
最佳直觉选点是 B6 (37.2%).
ㅤ​])`;


console.log('1:', text);
const sgf = new SgfModel(text);
console.log('2:', yaml.dump(sgf.ast));
console.log('2:', sgf.replays);
const text2 = sgf.toString();
console.log('2:', text2 === text ? 'match' : 'mismatch');
console.log('2:', text2);


// const sgf2 = new SgfModel(text2);
// console.log('3:', yaml.dump(sgf2.replays));
// const text3 = sgf.toString();
// console.log('3:', text3 === text2 ? 'match' : 'mismatch');
// console.log({ text3 });